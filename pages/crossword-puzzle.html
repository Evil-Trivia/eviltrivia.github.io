<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wedding Crossword Puzzle</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  
  <!-- Crossword Nexus CSS -->
  <link href="../crossword-solver/css/crosswordnexus.css" rel="stylesheet">
  
  <style>
    body {
      font-family: 'Roboto', Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #FFD34E 0%, #FFCC00 25%, #FFD34E 50%, #FFCC00 75%, #FFD34E 100%);
      background-size: 200px 200px;
      background-attachment: fixed;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-top: 20px;
      padding-bottom: 20px;
    }
    
    .container {
      max-width: 1000px;
      width: 95%;
      margin: 0 auto;
      position: relative;
      z-index: 2;
    }
    
    .card {
      background: linear-gradient(145deg, #ffffff, #f8f9fa);
      padding: 30px;
      border-radius: 20px;
      box-shadow: 
        0 20px 60px rgba(0,0,0,0.15),
        0 0 0 1px rgba(255,255,255,0.9) inset,
        0 2px 0 rgba(255,255,255,0.6) inset;
      margin-bottom: 30px;
      transition: all 0.6s cubic-bezier(0.165, 0.84, 0.44, 1);
      border: 1px solid rgba(255,255,255,0.3);
      overflow: hidden;
      position: relative;
      backdrop-filter: blur(10px);
    }
    
    h1 {
      text-align: center;
      background: linear-gradient(135deg, #333, #111, #333);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 20px;
      font-size: 2.5rem;
      font-weight: 800;
      text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
      letter-spacing: -1px;
      position: relative;
    }
    
    .crossword-container {
      width: 100%;
      height: 600px;
      margin: 20px 0;
      border: 2px solid #ddd;
      border-radius: 10px;
      overflow: hidden;
      background: white;
      position: relative;
    }
    
    .navigation-controls {
      display: flex;
      justify-content: center;
      margin-bottom: 25px;
    }
    
    .btn {
      display: inline-block;
      padding: 12px 24px;
      background: linear-gradient(135deg, #000000, #333333, #000000);
      color: white;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      text-decoration: none;
      text-align: center;
      transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
      margin: 0 10px;
    }
    
    .btn:hover {
      background: linear-gradient(135deg, #333333, #555555, #333333);
      transform: translateY(-2px);
    }
    
    .btn:disabled {
      background: linear-gradient(135deg, #cccccc, #e0e0e0, #cccccc);
      color: #888;
      cursor: not-allowed;
      transform: none;
    }
    
    /* Hide cheating functionality */
    .cw-check,
    .cw-reveal,
    .cw-menu-container.cw-check,
    .cw-menu-container.cw-reveal {
      display: none !important;
    }
    
    /* Style the crossword better */
    .crossword {
      position: relative !important;
      width: 100% !important;
      height: 100% !important;
    }
    
    .completion-section {
      text-align: center;
      margin-top: 20px;
      padding: 20px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
    }
    
    .completion-form {
      margin-top: 20px;
    }
    
    .completion-form input {
      padding: 12px;
      border: 2px solid #ddd;
      border-radius: 8px;
      margin: 0 10px;
      font-size: 16px;
      width: 200px;
    }
    
    .completion-form input:focus {
      border-color: #FFD700;
      outline: none;
    }
    
    .success-message {
      background: linear-gradient(135deg, #4CAF50, #66BB6A);
      color: white;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      display: none;
    }
    
    .error-message {
      background: linear-gradient(135deg, #f44336, #ef5350);
      color: white;
      padding: 15px;
      border-radius: 8px;
      margin: 10px 0;
      display: none;
    }
    
    @media (max-width: 768px) {
      .container {
        width: 98%;
        padding: 0 10px;
      }
      
      .card {
        padding: 20px;
      }
      
      h1 {
        font-size: 2rem;
      }
      
      .crossword-container {
        height: 500px;
      }
      
      .completion-form input {
        width: 150px;
        margin: 5px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Wedding Crossword Puzzle</h1>
    
    <div class="card">
      <div class="navigation-controls">
        <button onclick="goBack()" class="btn">‚Üê Back to Puzzles</button>
      </div>
      
      <div class="crossword-container">
        <div class="crossword" id="wedding-crossword"></div>
      </div>
      
      <div class="completion-section">
        <p style="color: #666; margin-bottom: 15px;">
          Complete the crossword puzzle above. All answers relate to the happy couple!
        </p>
        <p style="color: #666; font-style: italic; margin-bottom: 20px;">
          Note: You cannot check or reveal answers - solve it the traditional way!
        </p>
        
        <!-- Completion form for when crossword is solved -->
        <div class="completion-form" id="completion-form" style="display: none;">
          <h3>Crossword Complete! What's the secret word?</h3>
          <p>Look at the highlighted squares to find the final answer:</p>
          <form onsubmit="submitFinalAnswer(event)">
            <input type="text" id="final-answer" placeholder="Enter the secret word" required>
            <button type="submit" class="btn">Submit Answer</button>
          </form>
        </div>
        
        <div class="success-message" id="success-message">
          <h3>Congratulations!</h3>
          <p>You've successfully completed the crossword puzzle!</p>
        </div>
        
        <div class="error-message" id="error-message">
          That's not quite right. Try again!
        </div>
      </div>
    </div>
  </div>

  <!-- Crossword Nexus JavaScript -->
  <script src="../crossword-solver/js/crosswords.js"></script>
  <script src="../crossword-solver/lib/jquery.js"></script>
  <script src="../crossword-solver/lib/jscrossword_combined.js"></script>
  <script src="../crossword-solver/lib/lscache.min.js"></script>

  <script>
    let crosswordCompleted = false;
    let crosswordInstance = null;
    
    function goBack() {
      // Go back to main wedding puzzle page
      window.location.href = 'wedding.html';
    }
    
    function submitFinalAnswer(event) {
      event.preventDefault();
      
      const answer = document.getElementById('final-answer').value.trim().toLowerCase();
      const correctAnswer = 'love'; // Change this to your secret word
      
      if (answer === correctAnswer) {
        // Show success
        document.getElementById('success-message').style.display = 'block';
        document.getElementById('error-message').style.display = 'none';
        document.getElementById('completion-form').style.display = 'none';
        
        // Mark puzzle as complete in the wedding system
        setTimeout(() => {
          // You can integrate this with your wedding puzzle completion system
          alert('Puzzle completed! Moving to the next challenge...');
          goBack();
        }, 2000);
        
      } else {
        // Show error
        document.getElementById('error-message').style.display = 'block';
        setTimeout(() => {
          document.getElementById('error-message').style.display = 'none';
        }, 3000);
      }
    }
    
    // Initialize crossword
    $(document).ready(function() {
      // Configuration to disable cheating features
      var params = {
        // Styling options
        color_selected: '#FFD700',
        color_word: '#FEE300',
        color_hover: '#FFFFAA',
        
        // Puzzle file - you'll need to upload your CFP/PUZ file
        puzzle_file: {
          url: 'puzzles/wedding-crossword.cfp', // Change this to your puzzle file
          type: 'cfp' // or 'puz', 'jpz', 'ipuz' depending on your file
        },
        
        // User experience settings
        skip_filled_letters: true,
        arrow_direction: 'arrow_move_filled',
        space_bar: 'space_clear',
        timer_autostart: false,
        
        // Disable confetti on completion (since we have our own completion logic)
        confetti_enabled: false
      };
      
      // Create the crossword
      crosswordInstance = CrosswordNexus.createCrossword($('#wedding-crossword'), params);
      
      // Override the completion check to integrate with wedding puzzle system
      if (crosswordInstance) {
        // Poll for completion every few seconds
        setInterval(checkCrosswordCompletion, 2000);
      }
    });
    
    function checkCrosswordCompletion() {
      if (crosswordCompleted || !crosswordInstance) return;
      
      try {
        // Check if crossword is solved
        if (crosswordInstance.checkIfSolved && crosswordInstance.checkIfSolved(false)) {
          crosswordCompleted = true;
          
          // Show completion form
          document.getElementById('completion-form').style.display = 'block';
          
          // Scroll to completion section
          document.getElementById('completion-form').scrollIntoView({ 
            behavior: 'smooth' 
          });
        }
      } catch (error) {
        // Silently handle any errors
        console.log('Crossword check error:', error);
      }
    }
    
    // Additional security to hide any remaining cheating elements
    $(document).ready(function() {
      // Hide check and reveal buttons with multiple selectors
      $('.cw-check, .cw-reveal, [class*="check"], [class*="reveal"]').hide();
      
      // Also hide from any menu containers
      $('.cw-menu-container').each(function() {
        if ($(this).hasClass('cw-check') || $(this).hasClass('cw-reveal')) {
          $(this).hide();
        }
      });
      
      // Remove any buttons that might allow cheating
      $('button').each(function() {
        const text = $(this).text().toLowerCase();
        if (text.includes('reveal') || text.includes('check') || text.includes('solution')) {
          $(this).hide();
        }
      });
    });
    
    // Hide reveal/check functionality even more aggressively
    $(document).on('DOMNodeInserted', function(e) {
      if ($(e.target).hasClass('cw-check') || $(e.target).hasClass('cw-reveal')) {
        $(e.target).hide();
      }
    });
  </script>
</body>
</html> 